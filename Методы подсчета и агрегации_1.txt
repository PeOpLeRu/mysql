-- Упражнение 1

-- 1 По таблице clients из прошлого задания подсчитайте: 
-- а) общее количество записей (клиентов)
select count(*) from clients;
+----------+
| count(*) |
+----------+
|      378 |
+----------+

-- б) количество клиентов старше 1990 года
select count(*) from clients where YEAR(dbirth) > 1990;
+----------+
| count(*) |
+----------+
|       44 |
+----------+
-- в) количество клиентов с именем Thomas, Barbara, Willie (по каждому из имен);
select count(*) from clients where name='Thomas';
+----------+
| count(*) |
+----------+
|        5 |
+----------+
select count(*) from clients where name='Barbara';
+----------+
| count(*) |
+----------+
|        2 |
+----------+
select count(*) from clients where name='Willie';
+----------+
| count(*) |
+----------+
|        1 |
+----------+

-- 2 Подсчитайте сколько клиентов
-- а) по каждому году рождения
select count(*), YEAR(dbirth) as dbirth from clients group by YEAR(dbirth) order by YEAR(dbirth) DESC;
+----------+--------+
| count(*) | dbirth |
+----------+--------+
|        4 |   1999 |
|        5 |   1998 |
|        6 |   1997 |
|       10 |   1996 |
|        2 |   1995 |
|        2 |   1994 |
|        6 |   1993 |
|        5 |   1992 |
|        4 |   1991 |
|        2 |   1990 |
|        6 |   1989 |
|        6 |   1988 |
|        3 |   1987 |
|        7 |   1986 |
|        7 |   1985 |
|        4 |   1984 |
|        4 |   1983 |
|        9 |   1982 |
|        8 |   1981 |
|        3 |   1980 |
|        7 |   1979 |
|        4 |   1978 |
|        5 |   1977 |
|        5 |   1976 |
|        5 |   1975 |
|        5 |   1974 |
|        9 |   1973 |
|       12 |   1972 |
|        5 |   1971 |
|        6 |   1970 |
|        4 |   1969 |
|       10 |   1968 |
|       12 |   1967 |
|        4 |   1966 |
|        9 |   1965 |
|        5 |   1964 |
|        6 |   1963 |
|        5 |   1962 |
|        7 |   1961 |
|        2 |   1960 |
|        4 |   1959 |
|        5 |   1958 |
|        6 |   1957 |
|        5 |   1956 |
|       10 |   1955 |
|        5 |   1954 |
|        4 |   1953 |
|        5 |   1952 |
|        8 |   1951 |
|        3 |   1950 |
|        7 |   1949 |
|        4 |   1948 |
|        6 |   1947 |
|        5 |   1945 |
|        3 |   1944 |
|        5 |   1943 |
|        5 |   1942 |
|        5 |   1941 |
|        4 |   1940 |
|        4 |   1939 |
|        2 |   1938 |
|        7 |   1937 |
|        6 |   1936 |
|        9 |   1935 |
|        5 |   1934 |
|        3 |   1933 |
|        6 |   1932 |
|        1 |   1931 |
|        6 |   1930 |
+----------+--------+
-- б) по году рождения среди мужчин и женщин;
select count(*), YEAR(dbirth) as dbirth, gender from clients where gender='M' group by YEAR(dbirth) order by YEAR(dbirth) DESC;
+----------+--------+--------+
| count(*) | dbirth | gender |
+----------+--------+--------+
|        1 |   1999 | M      |
|        2 |   1998 | M      |
|        4 |   1997 | M      |
|        6 |   1996 | M      |
|        1 |   1994 | M      |
|        5 |   1993 | M      |
|        4 |   1992 | M      |
|        1 |   1991 | M      |
|        2 |   1989 | M      |
|        4 |   1988 | M      |
|        2 |   1987 | M      |
|        5 |   1986 | M      |
|        4 |   1985 | M      |
|        4 |   1984 | M      |
|        3 |   1983 | M      |
|        4 |   1982 | M      |
|        4 |   1981 | M      |
|        2 |   1980 | M      |
|        5 |   1979 | M      |
|        2 |   1978 | M      |
|        3 |   1977 | M      |
|        1 |   1976 | M      |
|        1 |   1975 | M      |
|        3 |   1974 | M      |
|        5 |   1973 | M      |
|        5 |   1972 | M      |
|        2 |   1971 | M      |
|        3 |   1970 | M      |
|        2 |   1969 | M      |
|        4 |   1968 | M      |
|        7 |   1967 | M      |
|        2 |   1966 | M      |
|        4 |   1965 | M      |
|        5 |   1964 | M      |
|        5 |   1963 | M      |
|        2 |   1962 | M      |
|        7 |   1961 | M      |
|        1 |   1960 | M      |
|        1 |   1959 | M      |
|        3 |   1958 | M      |
|        2 |   1957 | M      |
|        2 |   1956 | M      |
|        6 |   1955 | M      |
|        3 |   1954 | M      |
|        2 |   1953 | M      |
|        3 |   1952 | M      |
|        4 |   1951 | M      |
|        2 |   1950 | M      |
|        6 |   1949 | M      |
|        2 |   1948 | M      |
|        2 |   1947 | M      |
|        2 |   1945 | M      |
|        3 |   1944 | M      |
|        4 |   1943 | M      |
|        3 |   1942 | M      |
|        1 |   1941 | M      |
|        3 |   1940 | M      |
|        1 |   1938 | M      |
|        4 |   1937 | M      |
|        4 |   1936 | M      |
|        3 |   1935 | M      |
|        3 |   1934 | M      |
|        1 |   1933 | M      |
|        3 |   1932 | M      |
|        1 |   1931 | M      |
|        5 |   1930 | M      |
+----------+--------+--------+
select count(*), YEAR(dbirth) as dbirth, gender from clients where gender='F' group by YEAR(dbirth) order by YEAR(dbirth) DESC;
+----------+--------+--------+
| count(*) | dbirth | gender |
+----------+--------+--------+
|        3 |   1999 | F      |
|        3 |   1998 | F      |
|        2 |   1997 | F      |
|        4 |   1996 | F      |
|        2 |   1995 | F      |
|        1 |   1994 | F      |
|        1 |   1993 | F      |
|        1 |   1992 | F      |
|        3 |   1991 | F      |
|        2 |   1990 | F      |
|        4 |   1989 | F      |
|        2 |   1988 | F      |
|        1 |   1987 | F      |
|        2 |   1986 | F      |
|        3 |   1985 | F      |
|        1 |   1983 | F      |
|        5 |   1982 | F      |
|        4 |   1981 | F      |
|        1 |   1980 | F      |
|        2 |   1979 | F      |
|        2 |   1978 | F      |
|        2 |   1977 | F      |
|        4 |   1976 | F      |
|        4 |   1975 | F      |
|        2 |   1974 | F      |
|        4 |   1973 | F      |
|        7 |   1972 | F      |
|        3 |   1971 | F      |
|        3 |   1970 | F      |
|        2 |   1969 | F      |
|        6 |   1968 | F      |
|        5 |   1967 | F      |
|        2 |   1966 | F      |
|        5 |   1965 | F      |
|        1 |   1963 | F      |
|        3 |   1962 | F      |
|        1 |   1960 | F      |
|        3 |   1959 | F      |
|        2 |   1958 | F      |
|        4 |   1957 | F      |
|        3 |   1956 | F      |
|        4 |   1955 | F      |
|        2 |   1954 | F      |
|        2 |   1953 | F      |
|        2 |   1952 | F      |
|        4 |   1951 | F      |
|        1 |   1950 | F      |
|        1 |   1949 | F      |
|        2 |   1948 | F      |
|        4 |   1947 | F      |
|        3 |   1945 | F      |
|        1 |   1943 | F      |
|        2 |   1942 | F      |
|        4 |   1941 | F      |
|        1 |   1940 | F      |
|        4 |   1939 | F      |
|        1 |   1938 | F      |
|        3 |   1937 | F      |
|        2 |   1936 | F      |
|        6 |   1935 | F      |
|        2 |   1934 | F      |
|        2 |   1933 | F      |
|        3 |   1932 | F      |
|        1 |   1930 | F      |
+----------+--------+--------+

-- 3 Подсчитайте количество клиентов рожденных по разным месяцам (например, в январе - 15, в феврале - 4, и т.д.);
select count(*), date_format(dbirth, "%M") as dbirth from clients group by date_format(dbirth, "%M") order by date_format(dbirth, "%m") DESC;
+----------+-----------+
| count(*) | dbirth    |
+----------+-----------+
|       26 | December  |
|       31 | November  |
|       27 | October   |
|       27 | September |
|       36 | August    |
|       36 | July      |
|       27 | June      |
|       39 | May       |
|       36 | April     |
|       32 | March     |
|       28 | February  |
|       33 | January   |
+----------+-----------+

-- 4 Определите:
-- а) средний возраст по всем клиентам
select AVG(timestampdiff(YEAR, dbirth, NOW())) as avg_age from clients;
+---------+
| avg_age |
+---------+
| 56.0556 |
+---------+
-- б) минимальный возраст
select MIN(timestampdiff(YEAR, dbirth, NOW())) as min_age from clients;
+---------+
| min_age |
+---------+
|      22 |
+---------+
-- в) максимальный возраст;
select MAX(timestampdiff(YEAR, dbirth, NOW())) as max_age from clients;
+---------+
| max_age |
+---------+
|      92 |
+---------+


-- 5 Перечислите уникальные имена клиентов, рожденных в соответствующие периоды:
-- 1960-1969
select  GROUP_CONCAT(DISTINCT `name` ORDER BY `name`) as names from clients where YEAR(dbirth) >= 1960 and YEAR(dbirth) <= 1969;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| names                                                                                                                                                                                                                                                                                                                                                                           |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Ahti,Alan,Alec,Amos,Amy,Arthur,Barbara,Bennie,Betty,Beverly,Bryan,Carrie,Cheryl,Christopher,Clark,Clinton,David,Donna,Douglas,Elidia,Elizabeth,Enid,Ethel,Francine,Irene,Jeff,Jeffrey,Jim,John,Jonas,Joseph,Juri,Kenneth,Kevin,Kristel,Kurt,Lewis,Linda,Loretta,Michael,Michelle,Nicholas,Olive,Phyllis,Ronald,Rosemary,Ruth,Sharon,Sirje,Sten,Steven,Susan,Terry,Thomas,Walter |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
-- 1970-1979
select  GROUP_CONCAT(DISTINCT `name` ORDER BY `name`) as names from clients where YEAR(dbirth) >= 1970 and YEAR(dbirth) <= 1979;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| names                                                                                                                                                                                                                                                                                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Allison,Anne,Austin,Brandon,Carol,Charles,Christine,Christopher,Clarissa,Cora,Corinna,Daniel,Dennis,Devin,Dianne,Eddie,Erica,Ester,Ethel,Inge,Jan,Janet,Janice,Jean,Jeffrey,Jennifer,Jessica,Jesus,Kaarel,Kaja,Karen,Kati,Kellie,Kelly,Krista,Lawrence,Marcus,Mari,Maria,Mart,Michael,Micheal,Nancy,Nicholas,Patrick,Peep,Priit,Randy,Rick,Ricky,Robert,Ruby,Scott,Shirley,Siret,Tammy,Tara,Terry,Tom,Whitney |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
-- 1980-1989
select  GROUP_CONCAT(DISTINCT `name` ORDER BY `name`) as names from clients where YEAR(dbirth) >= 1980 and YEAR(dbirth) <= 1989;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| names                                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Alan,Arthur,Beverly,Brandi,Carly,Charles,Chase,Cindy,David,Dawn,Donna,Douglas,Eric,Frank,Glenda,Guillermo,Humberto,Irving,Janet,Jason,Jennifer,Jerry,Jesus,Joan,Jodie,John,Kimberly,Korey,Linda,Lucile,Lupe,Mary,Michael,Miranda,Ray,Raymond,Renae,Richard,Rick,Robert,Ronald,Rosemary,Sam,Samuel,Sandra,Stephen,Steven,Thomas,Tom,Tomasa,Willie,Zenaida |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
-- 1990-1999;
select  GROUP_CONCAT(DISTINCT `name` ORDER BY `name`) as names from clients where YEAR(dbirth) >= 1990 and YEAR(dbirth) <= 1999;
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| names                                                                                                                                                                                                                                                                                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Alphonso,Anthony,Betsy,Booker,Brandy,Carl,Christian,Christine,Clarice,Connie,Curtis,Deborah,Edward,Elise,Elsie,Emily,Evelyn,Fred,George,Goldie,James,Janet,Jeffrey,Jodie,Johanna,Jonathan,Jose,Keith,Laura,Lowell,Marie,Merlin,Morgan,Peggy,Penny,Rae,Raymond,Reina,Richard,Robert,Salvatore,Sherrie,Stephen,Tom |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

-- 6 Перечислите количество женщин и мужчин, рожденных в соответствующие периоды:
-- 1940-1949
select  count(*) as woman_quantity from clients where YEAR(dbirth) >= 1940 and YEAR(dbirth) <= 1949 and gender='F';
+----------------+
| woman_quantity |
+----------------+
|             18 |
+----------------+
select  count(*) as man_quantity from clients where YEAR(dbirth) >= 1940 and YEAR(dbirth) <= 1949 and gender='M';
+--------------+
| man_quantity |
+--------------+
|           26 |
+--------------+
-- 1950-1959
select  count(*) as woman_quantity from clients where YEAR(dbirth) >= 1950 and YEAR(dbirth) <= 1959 and gender='F';
+----------------+
| woman_quantity |
+----------------+
|             27 |
+----------------+
select  count(*) as man_quantity from clients where YEAR(dbirth) >= 1950 and YEAR(dbirth) <= 1959 and gender='M';
+--------------+
| man_quantity |
+--------------+
|           28 |
+--------------+
-- 1960-1969
select  count(*) as woman_quantity from clients where YEAR(dbirth) >= 1960 and YEAR(dbirth) <= 1969 and gender='F';
+----------------+
| woman_quantity |
+----------------+
|             25 |
+----------------+
select  count(*) as man_quantity from clients where YEAR(dbirth) >= 1960 and YEAR(dbirth) <= 1969 and gender='M';
+--------------+
| man_quantity |
+--------------+
|           39 |
+--------------+
-- 1970-1979
select  count(*) as woman_quantity from clients where YEAR(dbirth) >= 1970 and YEAR(dbirth) <= 1979 and gender='F';
+----------------+
| woman_quantity |
+----------------+
|             33 |
+----------------+
select  count(*) as man_quantity from clients where YEAR(dbirth) >= 1970 and YEAR(dbirth) <= 1979 and gender='M';
+--------------+
| man_quantity |
+--------------+
|           30 |
+--------------+